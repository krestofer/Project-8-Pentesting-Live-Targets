# Project-8-Pentesting-Live-Targets
Identifying and executing two vulnerabilities each of the blue, green and red versions of the Globitek websites.
# Project 8 - Pentesting Live Targets

Time spent: 14.5 hours spent in total

> Objective: Identify vulnerabilities in three different versions of the Globitek website: blue, green, and red.

The six possible exploits are:
* Username Enumeration
* Insecure Direct Object Reference (IDOR)
* SQL Injection (SQLi)
* Cross-Site Scripting (XSS)
* Cross-Site Request Forgery (CSRF)
* Session Hijacking/Fixation

Each version of the site has been given two of the six vulnerabilities. (In other words, all six of the exploits should be assignable to one of the sites.)


# Blue

### Vulnerability #1: SQL Injection

Codepath hint gave us a blind ejection example to try on the three different sites ' OR SLEEP(5)=0--' (I increased to 10 for effect). Challenge was first to find where to use it. I was already on the Find a Salesperson page and still took a while b4 getting the injection right. Using it on the red and green sites, nothing happened. They just rolled you immediately back to the list page:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/SQL%20red%20green%20no%20sleep%20effect.gif)

Whereas the blue site had a definite blind lag:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/SQL%20blue%20site%20blind%20works.gif)



### Vulnerability #2: Session Hijacking/Fixation

The second blue site vulnerability is the only one left, so I just applied the PHP script given by codepath instruction. Giving the ability to relive a previous session. The incognito chrome browser logs in and reveals session ID that we copy over to the firefox browswer stranger login on the left:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/SHF%20successful%20session%20ID%20switch.gif)


# Green

### Vulnerability #1: Username Enumeration

Login page is best here to challenge input for enumeration. At first, none of the attackable websites showed an obvious enumeration vulnerability by finding response differences from trying different usernames, even the codepath supplied existing "jmonroe99". Every website displayed the same:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/no%20clues.jpg)

Then there was a noticeble difference in the green site's text response. Most of the failed responses weren't coming back bold. Looked back again on other sites and most of their output came back the same in bold:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/Enumeration%20clues%20-%20other%20pages.gif)

Green returned bold only when the username was found indicating the developer handled the input two different ways and revealed it in the output:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/clue%20found%20bold%20font.gif)

Username enumeration usually occurs when a user-related form or URL returns different results when a user exists than when no user exists.

A deeper look showed the developer used different classes for the response. The 'failure' class had the bold font response that was used for incorrect passwords (known users):

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/failure%20class%20has%20bold%20return.jpg)

Whereas the 'failed' class didnt have the same font settings used when username didnt match database:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/failed%20class%20didnt%20have%20same%20settings.jpg)


### Vulnerability #2: Cross-site Scripting

Looking for a site that will take this xss script example given from codepath objective <script>alert('Mallory found the XSS!');</script> and render a stored xss attack, meaning we need the admin to trigger the effect. 
Challenge here was again where to input the test code. Something that eventually gave it away; viewing the source code of the contact pages showed green was missing some xxs prevention. The contact page is good hunting ground because comments can be posted for later interaction by the site admin, which is good ground for stored scripting.

The blue site's source page showed the developer escaped the "<>" characters with HTML entity coding (&alt) to prevent switching into my script:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/XSS%20blue%20site%20has%20prevention.jpg)

The green site doesnt do this, but works with whatever is given:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/XSS%20green%20site%20takes%20as%20is.jpg)

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/XSS%20owasp%20prevention%20cheat.jpg)
- owasp.org xxs prevention cheat sheet

So I have an incognito browser already logged into the sites on the right. My left window will show the bad actor.

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/XSS%20green%20plays%2C%20blue%20dont.gif)


# Red

### Vulnerability #1: Insecure Direct Object Reference

IDORs are usually best found and taken advantage of on pages that have lists. Looked at Find a Salesperson page, good hunting ground.
Clicking on salespersons names and noticing the way the profiles were identified in the url, I was hoping something cool would show on other profiles or after the numbers ran out. There must be only 9 active salespersons, cause the green and blue sites just returned user back to the salesperson list after 9. 

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/IDOR%20green%20blue%20return%202%20sales%20page.gif)

The red site returned input for id numbers after 9, and this information is most definitely sensitive, not to be public:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/IDOR%20red%20site%20returns%20sensitive%20info%20after%20id%20equals%209.gif)



### Vulnerability #2: Cross-Site Request-Forgery

After scrolling the pages logged in, editing salepeople seems doable. So I found the edit page link (form) I wanted to change:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/CSRF%20salespeople%20edit%20page.jpg)

Codepath hint suggests using provided example of a hidden, auto submitting form. Found the example and made my adjustments:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/CSRF%20make%20new%20form.jpg)

So again I'm already logged in on the right as admin. The bad actor on the left will insert code:

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/CSRF%20successful%20salesperson%20edit.gif)

And here's a clip of the aftermath seen from an outsider (Find a Salesperson page):

![web response](https://github.com/krestofer/Project-8-Pentesting-Live-Targets/blob/master/CSRF%20Find%20a%20Hacked%20Salesperson.jpg)

# Concept Review
_answers in italics_

__Which attacks were easiest to execute? Which were the most difficult?__

_After finishing, user enumeration still ended up being the easiest because of the method in determining the vulnerability. Looking for clues on UE is a lot less work. The Cross-site Request Forgery was the most difficult for me because it took me forever to get my form right and later realized I was sending the fake form to the wrong ip address._

__What is a good rule of thumb which would prevent accidentally username enumeration vulnerabilities like the one created here?__

  _If the page accepts a user identifier as input, then the output must not indicate if the user exists or not. This output includes not only the message returned to the user, but changes to the page contents (HTML, CSS, images, form structure or values), URL, or even cookie data. It is a good idea to write software tests which can make two requests—for a valid user and an invalid user—to any of these pages and compare the results to ensure they are identical. - codepath guide - username enumeration_
  
__Since you should be somewhat familiar with the CMS and how it was coded, can you think of another resource which could be made vulnerable to an Insecure Direct Object Reference? What code could be removed which would expose it?__



__Many SQL Injections use OR as part of the injected code. (For example ' OR 1=1 --'). Could AND work just as well in place of OR? Why or why not?__



__A stored XSS attack requires patience because it could be stored for months before being triggered. Because of this, what important ingredient would an attacker most likely include in a stored XSS attack script?__



__Imagine that one of your classmates is an authorized admin for the site's CMS and you are not. How would you get them to visit the self-submitting, hiddent page you created in Objective #5 (CSRF)?__

_Sending my classmate a private message containing a link I think they would fall for. A little social engineering may be needed._

__Compare session hijacking and session fixation. Which attack do you think is easier for an attacker to execute? Why? One of them is much easier to defend against the other. Which one and why?__

